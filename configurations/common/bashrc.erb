# skip this file on non-interactive shell
[ -z "$PS1" ] && return

# global variables
export PAGER=less
export EDITOR=vim

# set vi command editing mode
set -o vi

# dircolors
# enable color support of ls and also add handy aliases
if [ -x /usr/bin/dircolors ] && [ -f ~/.dircolors ]; then
    eval "$(dircolors -b ~/.dircolors)" || eval "$(dircolors -b)"
    alias ls='ls --color=auto'
    alias dir='dir --color=auto'
    alias vdir='vdir --color=auto'

    alias grep='grep --color=auto'
    alias fgrep='fgrep --color=auto'
    alias egrep='egrep --color=auto'
fi

# some more ls aliases
alias ll='ls -Ahl'
alias la='ls -A'
alias lg='la | grep'
alias l=ls

# useful aliases
alias v=vagrant
alias myip="curl -s icanhazip.com"

# add_PATH
add_PATH(){
    local d="${1/#\~/$HOME}"
    echo $PATH | grep -F "$d" >/dev/null || export PATH="$d":$PATH
}

# add LD_LIBRARY_PATH
add_LD_LIBRARY_PATH(){
    local d="${1/#\~/$HOME}"
    echo $LD_LIBRARY_PATH | grep -F "$d" >/dev/null || export LD_LIBRARY_PATH="$d":$LD_LIBRARY_PATH
}

# add MANPATH
add_MANPATH(){
    local d="${1/#\~/$HOME}"
    echo $MANPATH | grep -F "$d" >/dev/null || export MANPATH="$d":$MANPATH
}

<% if os == 'linux' %>
# ptop
ptop() {
    top -d 1 -c -p `pgrep $1 | paste -sd, -`
}

# vtop
vtop() {
    if pgrep VBoxHeadless > /dev/null; then
        top -d 1 -c `pgrep VBoxHeadless | awk '{print "-p " $0}' | tr '\n' ' '` -d 1
    else
        echo -e "There are no VirtualBox VM's currently running";
    fi
}

# GnuPGP Encryption/Decryption
e() {
    gpg2 -r 82430AB9 -o "$1.gpg" -e $1
}

d() {
    gpg2 -o "${1%.*}" -d $1
}

<% end %>

# fcd
fcd() { cd "$(fcdclient "$@")"; }
alias z=fcd

# Add bin directory to PATH
export PATH="$HOME/.local/bin":"<%= pwd+"/bin" %>":.:$PATH

# less colors and options
export LESS='-RS#3M~g'
export LESS_TERMCAP_md=$'\E[38;5;223m'
export LESS_TERMCAP_us=$'\E[38;5;181m'
export LESS_TERMCAP_mb=$'\E[01;31m'
export LESS_TERMCAP_so=$'\E[38;5;223m\E[48;5;238m'
export LESS_TERMCAP_me=$'\E[0m'
export LESS_TERMCAP_se=$'\E[0m'
export LESS_TERMCAP_ue=$'\E[0m'

# zsh only related options
if [ -n "$ZSH_VERSION" ]; then
    HISTFILE=~/.zsh_history
    HISTSIZE=10000
    SAVEHIST=100000
    setopt APPEND_HISTORY
    setopt AUTO_CD
    setopt LONGLISTJOBS
    # vi mode for zsh
    bindkey -v
    bindkey '^r' history-incremental-search-backward
    bindkey '^[[3~' delete-char
    bindkey '^[[Z' reverse-menu-complete
    export KEYTIMEOUT=1

    zstyle ':completion:*' menu select
    zstyle ':completion:*:default' list-colors ${(s.:.)LS_COLORS} 'ma=48;5;236;38;5;223'
    zstyle :compinstall filename "$HOME/.zshrc"

    autoload -Uz compinit && compinit
fi

# Add powerline prompt
if [ "$TERM" = "xterm-256color" ] || [ "$TERM" = "screen-256color" ]; then
    if [ -n "$ZSH_VERSION" ]; then
        function precmd(){ powerline 2> /dev/null; }
        PS1="%{[1m[38;5;222m[48;5;236m%} Œª %{[0m[38;5;236m%}ÓÇ∞%{[0m%} "
        PS2="%{[0m[38;5;222m[48;5;236m%} ‚Üê %{[0m[38;5;236m%}ÓÇ∞%{[0m%} "
    else
        PROMPT_COMMAND='powerline 2> /dev/null'
        PS1="\[\033[1m\033[38;5;222m\033[48;5;236m\] Œª \[\033[0m\033[38;5;236m\]ÓÇ∞\[\033[0m\] "
        PS2="\[\033[0m\033[38;5;222m\033[48;5;236m\] ‚Üê \[\033[0m\033[38;5;236m\]ÓÇ∞\[\033[0m\] "
    fi
fi
